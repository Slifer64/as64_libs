function fk = lwr4_fkine(q)
    s=[0,0,0,0,0,0,0]';  
    c=s;
    for i=1:7
        c(i) = cos(q(i));
        s(i) = sin(q(i));
    end

    fk(1,1)   = c(4)*s(1)*s(3)*s(5)*s(7)-c(1)*s(2)*s(4)*s(5)*s(7)-c(3)*c(5)*s(1)*s(7)-c(7)*s(1)*s(3)*s(4)*s(6)-c(1)*c(2)*c(5)*s(3)*s(7)-c(1)*c(4)*c(7)*s(2)*s(6)-c(3)*c(6)*c(7)*s(1)*s(5)-c(1)*c(2)*c(3)*c(4)*s(5)*s(7)+c(1)*c(2)*c(3)*c(7)*s(4)*s(6)-c(1)*c(2)*c(6)*c(7)*s(3)*s(5)+c(1)*c(5)*c(6)*c(7)*s(2)*s(4)-c(4)*c(5)*c(6)*c(7)*s(1)*s(3)+c(1)*c(2)*c(3)*c(4)*c(5)*c(6)*c(7);
    fk(1,2)   = c(1)*c(4)*s(2)*s(6)*s(7)-c(1)*c(7)*s(2)*s(4)*s(5)-c(3)*c(5)*c(7)*s(1)+c(4)*c(7)*s(1)*s(3)*s(5)+c(3)*c(6)*s(1)*s(5)*s(7)+s(1)*s(3)*s(4)*s(6)*s(7)-c(1)*c(2)*c(5)*c(7)*s(3)-c(1)*c(2)*c(3)*c(4)*c(7)*s(5)-c(1)*c(2)*c(3)*s(4)*s(6)*s(7)+c(1)*c(2)*c(6)*s(3)*s(5)*s(7)-c(1)*c(5)*c(6)*s(2)*s(4)*s(7)+c(4)*c(5)*c(6)*s(1)*s(3)*s(7)-c(1)*c(2)*c(3)*c(4)*c(5)*c(6)*s(7);
    fk(1,3)   = c(3)*s(1)*s(5)*s(6)-c(6)*s(1)*s(3)*s(4)-c(1)*c(4)*c(6)*s(2)+c(1)*c(2)*s(3)*s(5)*s(6)-c(1)*c(5)*s(2)*s(4)*s(6)+c(4)*c(5)*s(1)*s(3)*s(6)+c(1)*c(2)*c(3)*c(6)*s(4)-c(1)*c(2)*c(3)*c(4)*c(5)*s(6);
    fk(1,4)   = 0.39*c(1)*c(2)*c(3)*s(4)-0.39*c(1)*c(4)*s(2)-0.39*s(1)*s(3)*s(4)-0.4*c(1)*s(2)-0.088*c(1)*c(4)*c(6)*s(2)-0.088*c(6)*s(1)*s(3)*s(4)+0.088*c(3)*s(1)*s(5)*s(6)+0.088*c(1)*c(2)*s(3)*s(5)*s(6)-0.088*c(1)*c(5)*s(2)*s(4)*s(6)+0.088*c(4)*c(5)*s(1)*s(3)*s(6)+0.088*c(1)*c(2)*c(3)*c(6)*s(4)-0.088*c(1)*c(2)*c(3)*c(4)*c(5)*s(6);
    fk(2,1)   = c(1)*c(3)*c(5)*s(7)-c(2)*c(5)*s(1)*s(3)*s(7)-c(1)*c(4)*s(3)*s(5)*s(7)-c(4)*c(7)*s(1)*s(2)*s(6)+c(1)*c(7)*s(3)*s(4)*s(6)-s(1)*s(2)*s(4)*s(5)*s(7)+c(1)*c(3)*c(6)*c(7)*s(5)+c(1)*c(4)*c(5)*c(6)*c(7)*s(3)-c(2)*c(3)*c(4)*s(1)*s(5)*s(7)+c(2)*c(3)*c(7)*s(1)*s(4)*s(6)-c(2)*c(6)*c(7)*s(1)*s(3)*s(5)+c(5)*c(6)*c(7)*s(1)*s(2)*s(4)+c(2)*c(3)*c(4)*c(5)*c(6)*c(7)*s(1);
    fk(2,2)   = c(1)*c(3)*c(5)*c(7)-c(7)*s(1)*s(2)*s(4)*s(5)+c(4)*s(1)*s(2)*s(6)*s(7)-c(1)*s(3)*s(4)*s(6)*s(7)-c(2)*c(5)*c(7)*s(1)*s(3)-c(1)*c(4)*c(7)*s(3)*s(5)-c(1)*c(3)*c(6)*s(5)*s(7)-c(2)*c(3)*c(4)*c(7)*s(1)*s(5)-c(1)*c(4)*c(5)*c(6)*s(3)*s(7)-c(2)*c(3)*s(1)*s(4)*s(6)*s(7)+c(2)*c(6)*s(1)*s(3)*s(5)*s(7)-c(5)*c(6)*s(1)*s(2)*s(4)*s(7)-c(2)*c(3)*c(4)*c(5)*c(6)*s(1)*s(7);
    fk(2,3)   = c(1)*c(6)*s(3)*s(4)-c(4)*c(6)*s(1)*s(2)-c(1)*c(3)*s(5)*s(6)+c(2)*s(1)*s(3)*s(5)*s(6)-c(5)*s(1)*s(2)*s(4)*s(6)+c(2)*c(3)*c(6)*s(1)*s(4)-c(1)*c(4)*c(5)*s(3)*s(6)-c(2)*c(3)*c(4)*c(5)*s(1)*s(6);
    fk(2,4)   = 0.39*c(1)*s(3)*s(4)-0.39*c(4)*s(1)*s(2)-0.4*s(1)*s(2)+0.39*c(2)*c(3)*s(1)*s(4)-0.088*c(4)*c(6)*s(1)*s(2)+0.088*c(1)*c(6)*s(3)*s(4)-0.088*c(1)*c(3)*s(5)*s(6)+0.088*c(2)*s(1)*s(3)*s(5)*s(6)-0.088*c(5)*s(1)*s(2)*s(4)*s(6)+0.088*c(2)*c(3)*c(6)*s(1)*s(4)-0.088*c(1)*c(4)*c(5)*s(3)*s(6)-0.088*c(2)*c(3)*c(4)*c(5)*s(1)*s(6);
    fk(3,1)   = c(2)*c(4)*c(7)*s(6)-c(5)*s(2)*s(3)*s(7)+c(2)*s(4)*s(5)*s(7)-c(3)*c(4)*s(2)*s(5)*s(7)+c(3)*c(7)*s(2)*s(4)*s(6)-c(6)*c(7)*s(2)*s(3)*s(5)-c(2)*c(5)*c(6)*c(7)*s(4)+c(3)*c(4)*c(5)*c(6)*c(7)*s(2);
    fk(3,2)   = c(2)*c(7)*s(4)*s(5)-c(5)*c(7)*s(2)*s(3)-c(2)*c(4)*s(6)*s(7)-c(3)*s(2)*s(4)*s(6)*s(7)+c(6)*s(2)*s(3)*s(5)*s(7)-c(3)*c(4)*c(7)*s(2)*s(5)+c(2)*c(5)*c(6)*s(4)*s(7)-c(3)*c(4)*c(5)*c(6)*s(2)*s(7);
    fk(3,3)   = c(2)*c(4)*c(6)+c(3)*c(6)*s(2)*s(4)+c(2)*c(5)*s(4)*s(6)+s(2)*s(3)*s(5)*s(6)-c(3)*c(4)*c(5)*s(2)*s(6);
    fk(3,4)   = 0.4*c(2)+0.39*c(2)*c(4)+0.088*c(2)*c(4)*c(6)+0.39*c(3)*s(2)*s(4)+0.088*c(3)*c(6)*s(2)*s(4)+0.088*c(2)*c(5)*s(4)*s(6)+0.088*s(2)*s(3)*s(5)*s(6)+-0.088*c(3)*c(4)*c(5)*s(2)*s(6)+0.31;
    fk(4,1)   = 0;
    fk(4,2)   = 0;
    fk(4,3)   = 0;
    fk(4,4)   = 1;
end